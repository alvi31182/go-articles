# –°–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤ –≤ Go

–ü–µ—Ä–µ–¥ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ–º —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Å—Ç–∞—Ç—å—é [–∫–∞–Ω–∞–ª—ã –≤ Go](channel-ru.md), –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥—Ä–æ–±–Ω–æ –æ–±—ä—è—Å–Ω—è–µ—Ç —Ç–∏–ø—ã –∫–∞–Ω–∞–ª–æ–≤ –∏ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è. –ù–æ–≤–∏—á–∫–∞–º –≤ Go –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ç—É —Å—Ç–∞—Ç—å—é –∏ —Ç–µ–∫—É—â—É—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, —á—Ç–æ–±—ã –æ—Å–≤–æ–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–∞–Ω–∞–ª–∞–º–∏ Go.

–û—Å—Ç–∞–≤—à–∞—è—Å—è —á–∞—Å—Ç—å —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ –ø–æ–∫–∞–∂–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤. –Ø –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ —ç—Ç–∞ —Å—Ç–∞—Ç—å—è —É–±–µ–¥–∏—Ç –≤–∞—Å –≤ —Ç–æ–º, —á—Ç–æ:

* –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–∞–Ω–∞–ª–∞–º–∏ Go –ø—Ä–æ—Å—Ç–æ –∏ –ø—Ä–∏—è—Ç–Ω–æ.
* —Ç–µ—Ö–Ω–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∫–∞–Ω–∞–ª—ã –∏–º–µ–µ—Ç –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π –∏ –±–æ–ª—å—à–µ –≤–∞—Ä–∏–∞—Ü–∏–π, —á–µ–º —Ä–µ—à–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –º–æ–¥–µ–ª—å –∞–∫—Ç–æ—Ä–æ–≤ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω async/await.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ü–µ–ª—å —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤. –ú—ã –¥–æ–ª–∂–Ω—ã –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –∫–∞–Ω–∞–ª ‚Äî —ç—Ç–æ –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –≤ Go, –∏ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –ª—É—á—à–∏–º —Ä–µ—à–µ–Ω–∏–µ–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ [–∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏](https://go101.org/article/concurrent-atomic-operation.html) –∏ [–¥—Ä—É–≥–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏](https://go101.org/article/concurrent-synchronization-more.html) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –≤ Go.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –∫–∞–∫ Futures/Promises

Futures –∏ promises –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–æ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —è–∑—ã–∫–∞—Ö. –û–Ω–∏ —á–∞—Å—Ç–æ –∞—Å—Å–æ—Ü–∏–∏—Ä—É—é—Ç—Å—è —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏.

### –í–æ–∑–≤—Ä–∞—Ç –∫–∞–Ω–∞–ª–æ–≤ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `sumSquares` –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ. –ö–∞–∂–¥–∞—è –∏–∑ –¥–≤—É—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –ø—Ä–∏–µ–º–∞ –ø–æ –∫–∞–Ω–∞–ª—É –±—É–¥–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º –∫–∞–Ω–∞–ª–µ. –î–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–∫–æ–ª–æ —Ç—Ä–µ—Ö —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ —à–µ—Å—Ç–∏.

```go
package main

import (
	"time"
	"math/rand"
	"fmt"
)

func longTimeRequest() <-chan int32 {
	r := make(chan int32)

	go func() {
		// –ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏.
		time.Sleep(time.Second * 3)
		r <- rand.Int31n(100)
	}()

	return r
}

func sumSquares(a, b int32) int32 {
	return a*a + b*b
}

func main() {
	rand.Seed(time.Now().UnixNano()) // –Ω—É–∂–Ω–æ –¥–æ Go 1.20

	a, b := longTimeRequest(), longTimeRequest()
	fmt.Println(sumSquares(<-a, <-b))
}
```

### –ü–µ—Ä–µ–¥–∞—á–∞ –∫–∞–Ω–∞–ª–æ–≤ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤

–¢–∞–∫ –∂–µ, –∫–∞–∫ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø—Ä–∏–º–µ—Ä–µ, –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `sumSquares` –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞, —Ñ—É–Ω–∫—Ü–∏—è `longTimeRequest` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–∞–Ω–∞–ª —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤–º–µ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∫–∞–Ω–∞–ª–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è.

```go
package main

import (
	"time"
	"math/rand"
	"fmt"
)

func longTimeRequest(r chan<- int32)  {
	// –ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏.
	time.Sleep(time.Second * 3)
	r <- rand.Int31n(100)
}

func sumSquares(a, b int32) int32 {
	return a*a + b*b
}

func main() {
	rand.Seed(time.Now().UnixNano()) // –Ω—É–∂–Ω–æ –¥–æ Go 1.20

	ra, rb := make(chan int32), make(chan int32)
	go longTimeRequest(ra)
	go longTimeRequest(rb)

	fmt.Println(sumSquares(<-ra, <-rb))
}
```

–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä–∞ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω—ã –¥–≤–∞ –∫–∞–Ω–∞–ª–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Ç–æ–∂–µ –ø–æ–¥–æ–π–¥–µ—Ç.

```go
...

	// –ö–∞–Ω–∞–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –∏–ª–∏ –Ω–µ—Ç.
	results := make(chan int32, 2)
	go longTimeRequest(results)
	go longTimeRequest(results)

	fmt.Println(sumSquares(<-results, <-results))
}
```

–≠—Ç–æ —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ.

### –ü–µ—Ä–≤—ã–π –æ—Ç–≤–µ—Ç –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç

–≠—Ç–æ —É–ª—É—á—à–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞.

–ò–Ω–æ–≥–¥–∞ —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω–∞ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≤—ã—Å–æ–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏. –ò–∑-–∑–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ —ç—Ç–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è. –î–∞–∂–µ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –µ–≥–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ —Ç–∞–∫–∂–µ –Ω–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–∞. –ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ –∫–∞–∫ –º–æ–∂–Ω–æ –∫–æ—Ä–æ—á–µ, –º—ã –º–æ–∂–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ. –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –æ—Ç–≤–µ—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –±—É–¥—É—Ç –æ—Ç–±—Ä–æ—à–µ–Ω—ã.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –µ—Å–ª–∏ –µ—Å—Ç—å N –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –µ–º–∫–æ—Å—Ç—å –∫–∞–Ω–∞–ª–∞ —Å–≤—è–∑–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ N-1, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞–≤—Å–µ–≥–¥–∞ –≥–æ—Ä—É—Ç–∏–Ω, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –æ—Ç–±—Ä–æ—à–µ–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–∞–º.

```go
package main

import (
	"fmt"
	"time"
	"math/rand"
)

func source(c chan<- int32) {
	ra, rb := rand.Int31(), rand.Intn(3) + 1
	// –°–æ–Ω 1—Å/2—Å/3—Å.
	time.Sleep(time.Duration(rb) * time.Second)
	c <- ra
}

func main() {
	rand.Seed(time.Now().UnixNano()) // –Ω—É–∂–Ω–æ –¥–æ Go 1.20

	startTime := time.Now()
	// c –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –∫–∞–Ω–∞–ª–æ–º.
	c := make(chan int32, 5)
	for i := 0; i < cap(c); i++ {
		go source(c)
	}
	// –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –æ—Ç–≤–µ—Ç.
	rnd := <- c
	fmt.Println(time.Since(startTime))
	fmt.Println(rnd)
}
```

–ï—Å—Ç—å –¥—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è "–ø–µ—Ä–≤—ã–π –æ—Ç–≤–µ—Ç –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç", –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ö–∞–Ω–∏–∑–º select –∏ –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª —Å –µ–º–∫–æ—Å—Ç—å—é –æ–¥–∏–Ω. –î—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã –±—É–¥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–∏–∂–µ.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç

–ö–∞–Ω–∞–ª—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏, —á—Ç–æ–±—ã —Å—Ç–æ—Ä–æ–Ω–∞–º –æ—Ç–≤–µ—Ç–∞ –Ω–µ –Ω—É–∂–Ω–æ –±—ã–ª–æ –∂–¥–∞—Ç—å, –ø–æ–∫–∞ —Å—Ç–æ—Ä–æ–Ω—ã –∑–∞–ø—Ä–æ—Å–∞ –∑–∞–±–µ—Ä—É—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

–ò–Ω–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ—Ç–≤–µ—Ç–µ. –ü–æ —Ä–∞–∑–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –æ—à–∏–±–∫–∞. –î–ª—è —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞–µ–≤ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ç–∞–∫–æ–π –∫–∞–∫ `struct{v T; err error}` –∏–ª–∏ —Ç–∏–ø –ø—É—Å—Ç–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–∏–ø–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–∞–Ω–∞–ª–∞.

–ò–Ω–æ–≥–¥–∞ –ø–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∏—á–∏–Ω–∞–º –æ—Ç–≤–µ—Ç –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, —á–µ–º –æ–∂–∏–¥–∞–ª–æ—Å—å, —á—Ç–æ–±—ã –ø—Ä–∏–π—Ç–∏, –∏–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–∏–¥–µ—Ç. –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —Ç–∞–π–º–∞—É—Ç–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∏–∂–µ, –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞–∫–∏—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤.

–ò–Ω–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –æ—Ç–≤–µ—Ç–∞, —ç—Ç–æ —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö, —É–ø–æ–º—è–Ω—É—Ç—ã–π –ø–æ–∑–∂–µ –Ω–∏–∂–µ.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ –æ—Å–æ–±—ã–µ –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –≤–∞–∂–Ω—ã. –û–±—ã—á–Ω–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–∏–ø –ø—É—Å—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `struct{}` –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–∏–ø–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–∞–Ω–∞–ª–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –ø–æ—Å–∫–æ–ª—å–∫—É —Ä–∞–∑–º–µ—Ä —Ç–∏–ø–∞ `struct{}` —Ä–∞–≤–µ–Ω –Ω—É–ª—é, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∑–Ω–∞—á–µ–Ω–∏—è `struct{}` –Ω–µ –ø–æ—Ç—Ä–µ–±–ª—è—é—Ç –ø–∞–º—è—Ç—å.

### 1-–∫-1 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—É—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª

–ï—Å–ª–∏ –Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ –∫–∞–Ω–∞–ª–∞, —Ç–æ —Å–ª–µ–¥—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–µ–º–∞ –ø–æ –∫–∞–Ω–∞–ª—É –±—É–¥–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –¥—Ä—É–≥–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª, —á—Ç–æ–±—ã —É–≤–µ–¥–æ–º–∏—Ç—å –¥—Ä—É–≥—É—é –≥–æ—Ä—É—Ç–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –∂–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ç–æ–≥–æ –∂–µ –∫–∞–Ω–∞–ª–∞.

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –∫–∞–Ω–∞–ª `done` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–∏–≥–Ω–∞–ª—å–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

```go
package main

import (
	"crypto/rand"
	"fmt"
	"os"
	"sort"
)

func main() {
	values := make([]byte, 32 * 1024 * 1024)
	if _, err := rand.Read(values); err != nil {
		fmt.Println(err)
		os.Exit(1)
	}

	done := make(chan struct{}) // –º–æ–∂–µ—Ç –±—ã—Ç—å –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –∏–ª–∏ –Ω–µ—Ç

	// –ì–æ—Ä—É—Ç–∏–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
	go func() {
		sort.Slice(values, func(i, j int) bool {
			return values[i] < values[j]
		})
		// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.
		done <- struct{}{}
	}()

	// –¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –µ—â–µ ...

	<- done // –æ–∂–∏–¥–∞–Ω–∏–µ –∑–¥–µ—Å—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
	fmt.Println(values[0], values[len(values)-1])
}
```

### 1-–∫-1 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—É—Ç–µ–º –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–∞–Ω–∞–ª–∞

–ï—Å–ª–∏ –æ—á–µ—Ä–µ–¥—å –±—É—Ñ–µ—Ä–∞ –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞–Ω–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ (–æ—á–µ—Ä–µ–¥—å –±—É—Ñ–µ—Ä–∞ –Ω–µ–±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –≤—Å–µ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞), –æ–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –∫–∞–Ω–∞–ª –±—É–¥–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –¥—Ä—É–≥–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞, —á—Ç–æ–±—ã —É–≤–µ–¥–æ–º–∏—Ç—å –¥—Ä—É–≥—É—é –≥–æ—Ä—É—Ç–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –∂–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–æ—Ç –∂–µ –∫–∞–Ω–∞–ª. –û–±—ã—á–Ω–æ –∫–∞–Ω–∞–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º.

–≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ —Ä–µ–∂–µ, —á–µ–º —Å–ø–æ—Å–æ–±, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø—Ä–∏–º–µ—Ä–µ.

```go
package main

import (
	"fmt"
	"time"
)

func main() {
	done := make(chan struct{})
		// –ï–º–∫–æ—Å—Ç—å —Å–∏–≥–Ω–∞–ª—å–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç
		// –±—ã—Ç—å —Ä–∞–≤–Ω–∞ –æ–¥–Ω–æ–º—É. –ï—Å–ª–∏ —ç—Ç–æ —Ç–∞–∫, —Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
		// –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–∞–Ω–∞–ª –ø–µ—Ä–µ–¥
		// —Å–æ–∑–¥–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–µ–π –≥–æ—Ä—É—Ç–∏–Ω—ã.

	go func() {
		fmt.Print("Hello")
		// –ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏.
		time.Sleep(time.Second * 2)

		// –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–∞,
		// —á—Ç–æ–±—ã —É–≤–µ–¥–æ–º–∏—Ç—å –¥—Ä—É–≥—É—é –≥–æ—Ä—É—Ç–∏–Ω—É.
		<- done
	}()

	// –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏, —á—Ç–æ–±—ã —É–≤–µ–¥–æ–º–∏—Ç—å
	// –≥–æ—Ä—É—Ç–∏–Ω—É –≤—ã—à–µ.
	done <- struct{}{}
	fmt.Println(" world!")
}
```

### 1-–∫–æ-–º–Ω–æ–≥–∏–º –∏ –º–Ω–æ–≥–∏–µ-–∫-1 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (–∏–ª–∏ –ø–æ–ª—É—á–µ–Ω–æ) –∏–∑ –∫–∞–Ω–∞–ª–∞, –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥–æ—Ä—É—Ç–∏–Ω –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å (–∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å) –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ (–∏–ª–∏ –≤) —Ç–æ—Ç –∂–µ –∫–∞–Ω–∞–ª, —á—Ç–æ–±—ã –≤—Å–µ –æ–Ω–∏ –±—ã–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω—ã. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –¥–ª—è 1-–∫–æ-–º–Ω–æ–≥–∏–º –∏ –º–Ω–æ–≥–∏–µ-–∫-1 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 1-–∫–æ-–º–Ω–æ–≥–∏–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

```go
package main

import (
	"time"
	"fmt"
)

func main() {
	done := make(chan struct{})

	// –°–∏–≥–Ω–∞–ª—å–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞
	go func() {
		time.Sleep(time.Second)
		fmt.Println("done")
		// –£–≤–µ–¥–æ–º–∏—Ç—å –≤—Å–µ –≥–æ—Ä—É—Ç–∏–Ω—ã
		close(done)
	}()

	// –†–∞–±–æ—á–∏–µ –≥–æ—Ä—É—Ç–∏–Ω—ã
	for i := 0; i < 4; i++ {
		go func(id int) {
			<-done // –∂–¥–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
			fmt.Println("worker", id)
		}(i)
	}

	time.Sleep(time.Second * 2)
}
```

### –ú–Ω–æ–≥–∏–µ-–∫-1 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–º–µ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π –º–Ω–æ–≥–∏–µ-–∫-1 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

```go
package main

import (
	"fmt"
	"time"
	"math/rand"
)

func worker(id int, ready <-chan struct{}, done chan<- struct{}) {
	<-ready // –∂–¥–∞—Ç—å —Å–∏–≥–Ω–∞–ª–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
	fmt.Println("worker", id, "–∑–∞–ø—É—â–µ–Ω")
	time.Sleep(time.Second * time.Duration(rand.Intn(5)))
	fmt.Println("worker", id, "–∑–∞–≤–µ—Ä—à–µ–Ω")
	done <- struct{}{} // —É–≤–µ–¥–æ–º–∏—Ç—å –≥–ª–∞–≤–Ω—É—é –≥–æ—Ä—É—Ç–∏–Ω—É
}

func main() {
	rand.Seed(time.Now().UnixNano())

	ready, done := make(chan struct{}), make(chan struct{})
	go worker(0, ready, done)
	go worker(1, ready, done)
	go worker(2, ready, done)

	// –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
	time.Sleep(time.Second * 3 / 2)
	// –í—Å–µ–º —Ä–∞–±–æ—á–∏–º –≥–æ—Ä—É—Ç–∏–Ω–∞–º –ø–æ–¥–∞—Ç—å —Å–∏–≥–Ω–∞–ª –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
	close(ready)
	// –ñ–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —Ä–∞–±–æ—á–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω
	<-done
	<-done
	<-done
}
```

### –¢–∞–π–º–∞—É—Ç—ã –∏ –æ—Ç–º–µ–Ω—ã

–ú–µ—Ö–∞–Ω–∏–∑–º select-case –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–π–º–∞—É—Ç–æ–≤. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤—Ç–æ—Ä–æ–π case –¥–µ–ª–∞–µ—Ç –æ—Ç–º–µ–Ω—É –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –µ—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ.

```go
func doWithTimeout(timeout time.Duration) (int, error) {
	select {
	case result := <-fastRequest():
		return result, nil
	case <-time.After(timeout):
		return 0, errors.New("timeout")
	}
}
```

–ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–π. –í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ `cancel` –∫–∞–Ω–∞–ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏:

```go
func doWithCancel(cancel <-chan struct{}) (int, error) {
	select {
	case result := <-request():
		return result, nil
	case <-cancel:
		return 0, errors.New("–æ—Ç–º–µ–Ω–µ–Ω–æ")
	}
}
```

### –¢–∞–π–º–µ—Ä—ã –∏ —Ç–∏–∫–µ—Ä—ã

–•–æ—Ç—è –ø–∞–∫–µ—Ç `time` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `time.Timer` –∏ `time.Ticker`, –∫–∞–Ω–∞–ª—ã —Ç–∞–∫–∂–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–π–º–µ—Ä–æ–≤ –∏ —Ç–∏–∫–µ—Ä–æ–≤:

```go
// –¢–∞–π–º–µ—Ä
func timer(d time.Duration) <-chan time.Time {
	c := make(chan time.Time, 1)
	go func() {
		time.Sleep(d)
		c <- time.Now()
	}()
	return c
}

// –¢–∏–∫–µ—Ä
func ticker(d time.Duration) <-chan time.Time {
	c := make(chan time.Time, 1)
	go func() {
		for {
			time.Sleep(d)
			select {
			case c <- time.Now():
			default:
			}
		}
	}()
	return c
}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö

–ö–∞–Ω–∞–ª—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤.

### –¢–æ—á–∫–∞-—Ç–æ—á–∫–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–æ—á–∫–∞-—Ç–æ—á–∫–∞:

```go
func main() {
	c := make(chan int)

	go func() {
		c <- 42 // –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
	}()

	data := <-c // –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
	fmt.Println(data)
}
```

### –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö

–ö–∞–Ω–∞–ª—ã –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö. –í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø–æ—Ç–æ–∫–∞ —á–∏—Å–µ–ª:

```go
func numberStream() <-chan int {
	c := make(chan int)
	go func() {
		defer close(c)
		for i := 0; i < 10; i++ {
			c <- i
		}
	}()
	return c
}

func main() {
	for num := range numberStream() {
		fmt.Println(num)
	}
}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏

–ö–∞–Ω–∞–ª—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö—Å—è –æ–ø–µ—Ä–∞—Ü–∏–π:

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Å –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏

```go
func main() {
	const limit = 3
	semaphore := make(chan struct{}, limit)

	for i := 0; i < 10; i++ {
		semaphore <- struct{}{} // –∑–∞—Ö–≤–∞—Ç
		go func(id int) {
			defer func() { <-semaphore }() // –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ
			// –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É
			fmt.Println("—Ä–∞–±–æ—Ç–∞", id)
		}(i)
	}

	// –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —Ä–∞–±–æ—Ç
	for i := 0; i < limit; i++ {
		semaphore <- struct{}{}
	}
}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏

–ö–∞–Ω–∞–ª—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏:

### –ë–∞—Ä—å–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```go
func main() {
	const numWorkers = 3
	barrier := make(chan struct{})

	for i := 0; i < numWorkers; i++ {
		go func(id int) {
			// –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É
			fmt.Println("worker", id, "—Ä–∞–±–æ—Ç–∞–µ—Ç")
			barrier <- struct{}{} // —Å–∏–≥–Ω–∞–ª –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
		}(i)
	}

	// –¥–æ–∂–¥–∞—Ç—å—Å—è –≤—Å–µ—Ö —Ä–∞–±–æ—á–∏—Ö
	for i := 0; i < numWorkers; i++ {
		<-barrier
	}
	fmt.Println("–≤—Å–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ")
}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –ø—É–ª–æ–≤ –≤–æ—Ä–∫–µ—Ä–æ–≤

–ö–∞–Ω–∞–ª—ã –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—É–ª–æ–≤ –≤–æ—Ä–∫–µ—Ä–æ–≤:

### –ü—Ä–æ—Å—Ç–æ–π –ø—É–ª –≤–æ—Ä–∫–µ—Ä–æ–≤

```go
func worker(id int, jobs <-chan int, results chan<- int) {
	for job := range jobs {
		// –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É
		result := job * 2
		results <- result
	}
}

func main() {
	const numWorkers = 3
	const numJobs = 9

	jobs := make(chan int, numJobs)
	results := make(chan int, numJobs)

	// –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Ä–∫–µ—Ä–æ–≤
	for i := 0; i < numWorkers; i++ {
		go worker(i, jobs, results)
	}

	// –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è
	for j := 1; j <= numJobs; j++ {
		jobs <- j
	}
	close(jobs)

	// –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
	for r := 1; r <= numJobs; r++ {
		fmt.Println(<-results)
	}
}
```

## –°–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö

–° –ø–æ–º–æ—â—å—é –∫–∞–Ω–∞–ª–æ–≤ –æ—á–µ–Ω—å –ª–µ–≥–∫–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö. –û–±—ã—á–Ω–æ –≤ —Å–∏—Å—Ç–µ–º–µ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥—É–ª–µ–π (–≤–æ—Ä–∫–µ—Ä–æ–≤), –∏ –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É.

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö. –í–æ—Ç –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä:

```go
func RandomGenerator() <-chan uint64 {
	c := make(chan uint64)
	go func() {
		r := rand.New(rand.NewSource(time.Now().UnixNano()))
		for {
			c <- r.Uint64()
		}
	}()
	return c
}
```

### –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ú–æ–¥—É–ª—å –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫. –í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–∏–Ω—è—Ç—ã–µ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤, –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –æ–¥–∏–Ω –≤—ã—Ö–æ–¥–Ω–æ–π –∫–∞–Ω–∞–ª:

```go
func Aggregator(inputs ...<-chan uint64) <-chan uint64 {
	output := make(chan uint64)
	var wg sync.WaitGroup
	wg.Add(len(inputs))

	for _, input := range inputs {
		go func(in <-chan uint64) {
			defer wg.Done()
			for x := range in {
				output <- x
			}
		}(input)
	}

	go func() {
		wg.Wait()
		close(output)
	}()

	return output
}
```

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ú–æ–¥—É–ª—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥—É—é —á–∞—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤. –ö–∞–∂–¥–∞—è —á–∞—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –ø—Ä–æ–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∞, –∏ –∫–∞–∂–¥—ã–π –∏–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —Ä–∞–∑–Ω—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä–∏–º–µ—Ä:

```go
func Duplicator(in <-chan uint64) (<-chan uint64, <-chan uint64) {
	outA, outB := make(chan uint64), make(chan uint64)
	go func() {
		for x := range in {
			outA <- x
			outB <- x
		}
	}()
	return outA, outB
}
```

### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ/–∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –º–æ–¥—É–ª–µ–π –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è, –∏ –∫–∞–∂–¥–∞—è –æ—á–µ–Ω—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞. –û–±—ã—á–Ω–æ —Ñ—É–Ω–∫—Ü–∏—è-–≤–æ—Ä–∫–µ—Ä —Ç–∞–∫–æ–≥–æ –º–æ–¥—É–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–∞–∂–¥—É—é —á–∞—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –¥—Ä—É–≥—É—é —á–∞—Å—Ç—å –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–í —Ü–µ–ª—è—Ö –ø—Ä–æ—Å—Ç–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∑–¥–µ—Å—å –ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä –≤–æ—Ä–∫–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π –±–∏—Ç –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è `uint64`.

```go
func Calculator(in <-chan uint64, out chan uint64) (<-chan uint64) {
	if out == nil {
		out = make(chan uint64)
	}
	go func() {
		for x := range in {
			out <- ^x
		}
	}()
	return out
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è/—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ú–æ–¥—É–ª—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ—Ç–æ–∫–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–µ–¥—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è-–≤–æ—Ä–∫–µ—Ä –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –≤—Å–µ –Ω–µ –ø—Ä–æ—Å—Ç—ã–µ —á–∏—Å–ª–∞.

```go
import "math/big"

func Filter0(input <-chan uint64, output chan uint64) <-chan uint64 {
	if output == nil {
		output = make(chan uint64)
	}
	go func() {
		bigInt := big.NewInt(0)
		for x := range input {
			bigInt.SetUint64(x)
			if bigInt.ProbablyPrime(1) {
				output <- x
			}
		}
	}()
	return output
}

func Filter(input <-chan uint64) <-chan uint64 {
	return Filter0(input, nil)
}
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫–∞–∂–¥–∞—è –∏–∑ –¥–≤—É—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –¥–≤—É—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤, –ø–æ–∫–∞–∑–∞–Ω–Ω—ã—Ö –Ω–∏–∂–µ.

### –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–û–±—ã—á–Ω–æ –º–æ–¥—É–ª—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏–ª–∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–º –≤—ã—Ö–æ–¥–Ω—ã–º –º–æ–¥—É–ª–µ–º –≤ —Å–∏—Å—Ç–µ–º–µ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö. –ó–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –ø—Ä–æ—Å—Ç–æ–π –≤–æ—Ä–∫–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—á–∞—Ç–∞–µ—Ç –∫–∞–∂–¥—É—é —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

```go
import "fmt"

func Printer(input <-chan uint64) {
	for x := range input {
		fmt.Println(x)
	}
}
```

### –°–±–æ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏-–≤–æ—Ä–∫–µ—Ä—ã –º–æ–¥—É–ª–µ–π –¥–ª—è —Å–±–æ—Ä–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∏—Å—Ç–µ–º –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö. –°–±–æ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –∏ —É–∫–∞–∑–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞.

–ü—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö 1 (–ª–∏–Ω–µ–π–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä):

```go
package main

... // —Ñ—É–Ω–∫—Ü–∏–∏-–≤–æ—Ä–∫–µ—Ä—ã, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—à–µ.

func main() {
	Printer(
		Filter(
			Calculator(
				RandomGenerator(), nil,
			),
		),
	)
}
```

–ü—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö 2 (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –≥—Ä–∞—Ñ –∫–æ–Ω–≤–µ–π–µ—Ä):

```go
package main

... // —Ñ—É–Ω–∫—Ü–∏–∏-–≤–æ—Ä–∫–µ—Ä—ã, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—à–µ.

func main() {
	filterA := Filter(RandomGenerator())
	filterB := Filter(RandomGenerator())
	filterC := Filter(RandomGenerator())
	filter := Aggregator(filterA, filterB, filterC)
	calculatorA := Calculator(filter, nil)
	calculatorB := Calculator(filter, nil)
	calculator := Aggregator(calculatorA, calculatorB)
	Printer(calculator)
}
```

–ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è —Ç–æ–ø–æ–ª–æ–≥–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –≥—Ä–∞—Ñ–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–∏—Å—Ç–µ–º–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –≤—ã—Ö–æ–¥–æ–≤. –ù–æ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å —Ç–æ–ø–æ–ª–æ–≥–∏–µ–π —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞—Ñ–∞ —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏.

–ò–∑ –¥–≤—É—Ö –≤—ã—à–µ–ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –º—ã –º–æ–∂–µ–º –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å, —á—Ç–æ –æ—á–µ–Ω—å –ª–µ–≥–∫–æ –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å –∫–∞–Ω–∞–ª–∞–º–∏.

–ò–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –º—ã –º–æ–∂–µ–º –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å, —á—Ç–æ —Å –ø–æ–º–æ—â—å—é –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–æ–≤ –ª–µ–≥–∫–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å fan-in –∏ fan-out –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è.

–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –∫–∞–Ω–∞–ª –¥–ª—è –∑–∞–º–µ–Ω—ã —Ä–æ–ª–∏ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–º–µ—Ä –∑–∞–º–µ–Ω—è–µ—Ç –¥–≤–∞ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞ –¥–≤—É–º—è –∫–∞–Ω–∞–ª–∞–º–∏.

```go
package main

... // —Ñ—É–Ω–∫—Ü–∏–∏-–≤–æ—Ä–∫–µ—Ä—ã, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—à–µ.

func main() {
	c1 := make(chan uint64, 100)
	Filter0(RandomGenerator(), c1) // filterA
	Filter0(RandomGenerator(), c1) // filterB
	Filter0(RandomGenerator(), c1) // filterC
	c2 := make(chan uint64, 100)
	Calculator(c1, c2) // calculatorA
	Calculator(c1, c2) // calculatorB
	Printer(c2)
}
```

–í—ã—à–µ–ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –º–Ω–æ–≥–æ —Ç–æ–≥–æ, –∫–∞–∫ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ [—ç—Ç—É —Å—Ç–∞—Ç—å—é](https://go101.org/article/channel-closing.html) –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π –æ —Ç–æ–º, –∫–∞–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã.

---

## üéØ –ó–∞–¥–∞–Ω–∏—è –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è

### üß© –£—Ä–æ–≤–µ–Ω—å 1 ‚Äî –ë–∞–∑–æ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ –∫–∞–Ω–∞–ª

**–ó–∞–¥–∞—á–∞:**

–ù–∞–ø–∏—à–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É, –≤ –∫–æ—Ç–æ—Ä–æ–π:
- –û–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –∫–∞–Ω–∞–ª —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 5.
- –î—Ä—É–≥–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–∏ —á–∏—Å–ª–∞ –∏ –ø–µ—á–∞—Ç–∞–µ—Ç –∏—Ö.
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–∞–Ω–∞–ª –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –∞ –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `for range` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

**–ß—Ç–æ –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è:**

- –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–∞–Ω–∞–ª;
- –∑–∞–∫—Ä—ã—Ç–∏–µ –∫–∞–Ω–∞–ª–∞;
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `for range` –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è.

---

### ‚öôÔ∏è –£—Ä–æ–≤–µ–Ω—å 2 ‚Äî –ù–µ—Å–∫–æ–ª—å–∫–æ –≥–æ—Ä—É—Ç–∏–Ω –∏ –±—É—Ñ–µ—Ä

**–ó–∞–¥–∞—á–∞:**

–°–æ–∑–¥–∞–π –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª —ë–º–∫–æ—Å—Ç—å—é 3.

- –ó–∞–ø—É—Å—Ç–∏ 3 –≥–æ—Ä—É—Ç–∏–Ω—ã-–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø–∏—à–µ—Ç –≤ –∫–∞–Ω–∞–ª —Å–≤–æ—ë –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "A", "B", "C").
- –ó–∞–ø—É—Å—Ç–∏ –≥–æ—Ä—É—Ç–∏–Ω—É-–ø—Ä–∏—ë–º–Ω–∏–∫, –∫–æ—Ç–æ—Ä–∞—è —á–∏—Ç–∞–µ—Ç –∏–∑ –∫–∞–Ω–∞–ª–∞ –∏ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
- –ó–∞–∫—Ä–æ–π –∫–∞–Ω–∞–ª –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—Å–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏ —Ä–∞–±–æ—Ç—É.

**–ß—Ç–æ –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è:**

- –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã;
- –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞;
- —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sync.WaitGroup`).

---

### ‚ö° –£—Ä–æ–≤–µ–Ω—å 3 ‚Äî –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ select

**–ó–∞–¥–∞—á–∞:**

–ù–∞–ø–∏—à–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É, –≥–¥–µ –¥–≤–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Ä–∞–∑–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –¥–≤–∞ –∫–∞–Ω–∞–ª–∞:

- –ø–µ—Ä–≤–∞—è ‚Äî "ping",
- –≤—Ç–æ—Ä–∞—è ‚Äî "pong".

–ì–ª–∞–≤–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `select` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –ª—é–±–æ–≥–æ –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ –∏ –ø–µ—á–∞—Ç–∞–µ—Ç –∏—Ö.

–ï—Å–ª–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 5 —Å–µ–∫—É–Ω–¥ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É.

**–ß—Ç–æ –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è:**

- `select-case` –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤;
- –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π;
- —Ä–∞–±–æ—Ç–∞ —Å `time.After` –¥–ª—è —Ç–∞–π–º-–∞—É—Ç–æ–≤.

---

### üöÄ –£—Ä–æ–≤–µ–Ω—å 4 ‚Äî –°–ª–æ–∂–Ω–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è

**–ó–∞–¥–∞—á–∞:**

–†–µ–∞–ª–∏–∑—É–π "–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å‚Äì–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å":

- –ì–æ—Ä—É—Ç–∏–Ω–∞-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 10 –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ –∫–∞–Ω–∞–ª.
- –î–≤–µ –≥–æ—Ä—É—Ç–∏–Ω—ã-–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è —á–∏—Ç–∞—é—Ç —ç—Ç–∏ —á–∏—Å–ª–∞ —á–µ—Ä–µ–∑ `select`, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–æ–∑–≤–æ–¥—è—Ç –≤ –∫–≤–∞–¥—Ä–∞—Ç) –∏ –≤—ã–≤–æ–¥—è—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
- –ö–æ–≥–¥–∞ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—á–∏—Ç–∞–Ω—ã ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è.

**–ß—Ç–æ –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è:**

- –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ –∫–∞–Ω–∞–ª;
- –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞;
- –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Å–µ—Ö –≥–æ—Ä—É—Ç–∏–Ω –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –∫–∞–Ω–∞–ª–∞.

---

### üß† –£—Ä–æ–≤–µ–Ω—å 5 ‚Äî –ó–∞–¥–∞—á–∞ –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ GC –∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

**–ó–∞–¥–∞—á–∞:**

–°–æ–∑–¥–∞–π –≥–æ—Ä—É—Ç–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –∂–¥—ë—Ç —á—Ç–µ–Ω–∏—è –∏–∑ –Ω–µ–±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–∏—à–µ—Ç –≤ –Ω–µ–≥–æ.

–ü–æ—Å–º–æ—Ç—Ä–∏, –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ "–∑–∞–≤–∏—Å–∞–µ—Ç" (–≥–æ—Ä—É—Ç–∏–Ω–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞).

–ó–∞—Ç–µ–º –¥–æ–±–∞–≤—å `select {}` ‚Äî –∏ —É–±–µ–¥–∏—Å—å, —á—Ç–æ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ —Ç–æ–∂–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞.

**–ß—Ç–æ –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è:**

- –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω;
- –ø–æ–Ω–∏–º–∞–Ω–∏–µ, –∫–æ–≥–¥–∞ –∫–∞–Ω–∞–ª –∏ –≥–æ—Ä—É—Ç–∏–Ω–∞ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ–±—Ä–∞–Ω—ã GC;
- –ø—Ä–∞–∫—Ç–∏–∫–∞ –æ—Ç–ª–∞–¥–∫–∏ –∑–∞–≤–∏—Å—à–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω (`go tool pprof`, `runtime.NumGoroutine()`).

---

**–ò—Å—Ç–æ—á–Ω–∏–∫:** [Channel Use Cases - Go 101](https://go101.org/article/channel-use-cases.html)

